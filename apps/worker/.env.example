# Worker environment (remote-only Supabase + SerpAPI canonical discovery)

NODE_ENV=development
APP_ENV=local
LOG_LEVEL=debug

# ----------------------------
# Database (REMOTE Supabase ONLY)
# Use the Supabase Session Pooler connection string (IPv4 compatible) and require SSL.
# Example format:
# postgresql://postgres.<project-ref>:<DB_PASSWORD>@aws-<n>-<region>.pooler.supabase.com:5432/postgres?sslmode=require
# NOTE: If your password contains special characters, URL-encode it.
DATABASE_URL=
DIRECT_URL=

# pg-boss schema namespace (leave as default unless you have a reason)
PG_BOSS_SCHEMA=pgboss

# ----------------------------
# Supabase (only required for CLI automation or if worker calls Supabase HTTP APIs)
SUPABASE_PROJECT_REF=cbcgrzvqidtrtrtnzlso

# Optional: for non-interactive Supabase CLI usage (CI). Locally you can usually rely on `supabase login`.
SUPABASE_ACCESS_TOKEN=

# Optional: only if scripts require it (worker typically uses DATABASE_URL instead).
SUPABASE_DB_PASSWORD=

# Optional: ONLY set if worker uses Supabase HTTP APIs with privileged access.
# Never commit. Never expose to the browser.
SUPABASE_SERVICE_ROLE_KEY=

# ----------------------------
# Discovery pipeline toggles
# Legacy adapter-based discovery.run pipeline (deprecated)
DISCOVERY_ENABLED=false

# Canonical discovery pipeline (SerpAPI search-task pipeline)
SERPAPI_DISCOVERY_ENABLED=true

# ----------------------------
# SerpAPI (required for canonical discovery)
SERPAPI_API_KEY=

# Task generation + execution knobs
DISCOVERY_COUNTRIES=JO,SA,AE,EG
DISCOVERY_LANGUAGES=en,ar

# Keep conservative defaults while validating (increase carefully)
DISCOVERY_MAX_PAGES_PER_QUERY=1

# allowed: daily|weekly
DISCOVERY_REFRESH_BUCKET=weekly

# SerpAPI rate limiting + worker parallelism
DISCOVERY_RPS=1
DISCOVERY_CONCURRENCY=1

# If true, allow SerpAPI cached responses (cheaper/faster). Set false if you need fresh results.
DISCOVERY_ENABLE_CACHE=true

# google_maps city-wide default zoom (3-20). Lower = wider area.
DISCOVERY_MAPS_ZOOM=13

# Retries/backoff
DISCOVERY_MAX_TASK_ATTEMPTS=3
DISCOVERY_BACKOFF_BASE_SECONDS=30

# Safety cap for bounded validation runs (recommended on shared DB)
DISCOVERY_RUN_MAX_TASKS=40
# Auto-enqueue discovery seed + run loop when worker starts (recommended false for local dev)
DISCOVERY_BOOTSTRAP_ON_START=false
# Enable legacy discovery queue consumers (discovery.run / discovery.seed / discovery.run_search_task).
# Leave empty to use default behavior (disabled in local APP_ENV, enabled otherwise).
DISCOVERY_QUEUE_WORKERS_ENABLED=

# Enable cron schedules (heartbeat/labels/train/etc.). Default behavior:
# - local APP_ENV: disabled unless explicitly true
# - non-local APP_ENV: enabled
WORKER_ENABLE_SCHEDULES=

# DB-backed job request dispatcher (public.job_requests)
JOB_REQUEST_POLL_MS=5000
JOB_REQUEST_MAX_PER_TICK=1
JOB_REQUEST_WORKER_ID=

# ----------------------------
# Discovery seed profiles (frontier seeding)
DISCOVERY_SEED_PROFILE=default
DISCOVERY_SEED_MAX_TASKS=40
DISCOVERY_SEED_MAX_PAGES=1
DISCOVERY_SEED_COUNTRIES=AE,SA,JO,EG
DISCOVERY_SEED_LANGUAGES=en,ar
DISCOVERY_SEED_TASK_TYPES=SERP_MAPS_LOCAL,SERP_GOOGLE_LOCAL

# Suffix appended to time_bucket to help isolate runs (highly recommended)
# Example: zack-dev, ui-validation, w08-maps-zoom13
DISCOVERY_SEED_BUCKET=zack-dev

# ----------------------------
# Optional future providers (NOT USED CURRENTLY)
# Keep disabled unless you implement and enable the provider adapters.

BRAVE_SEARCH_ENABLED=false
BRAVE_SEARCH_API_KEY=
BRAVE_SEARCH_BASE_URL=https://api.search.brave.com/res/v1/web/search
BRAVE_SEARCH_RATE_LIMIT_MS=250

GOOGLE_PLACES_ENABLED=false
GOOGLE_PLACES_API_KEY=
GOOGLE_PLACES_BASE_URL=https://places.googleapis.com/v1/places:searchText
GOOGLE_PLACES_RATE_LIMIT_MS=250

LINKEDIN_SCRAPE_ENABLED=false
LINKEDIN_SCRAPE_ENDPOINT=
LINKEDIN_SCRAPE_API_KEY=

COMPANY_SEARCH_ENABLED=false
COMPANY_SEARCH_BASE_URL=https://autocomplete.clearbit.com/v1/companies/suggest

APOLLO_ENABLED=false
APOLLO_API_KEY=
APOLLO_BASE_URL=https://api.apollo.io
APOLLO_RATE_LIMIT_MS=250

# Google CSE / Custom Search is deprecated and not supported (intentionally omitted).

# ----------------------------
# Enrichment pipeline (OFF by default; enable only when keys are set)
ENRICHMENT_ENABLED=false
ENRICHMENT_DEFAULT_PROVIDER=HUNTER

HUNTER_ENABLED=false
HUNTER_API_KEY=
HUNTER_BASE_URL=https://api.hunter.io/v2
HUNTER_RATE_LIMIT_MS=250

CLEARBIT_ENABLED=false
CLEARBIT_API_KEY=
CLEARBIT_PERSON_BASE_URL=https://person.clearbit.com/v2/people/find
CLEARBIT_COMPANY_BASE_URL=https://company.clearbit.com/v2/companies/find

PDL_ENABLED=false
PDL_API_KEY=
PDL_BASE_URL=https://api.peopledatalabs.com
PDL_RATE_LIMIT_MS=250

OTHER_FREE_ENRICHMENT_ENABLED=false
PUBLIC_LOOKUP_BASE_URL=https://autocomplete.clearbit.com/v1/companies/suggest
